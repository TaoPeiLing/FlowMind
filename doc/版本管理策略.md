# 心流 - 版本管理策略

## 一、分支管理策略

### 1. 基本分支结构
- **main**: 主分支，用于生产环境
- **develop**: 开发主分支，所有开发工作基于此分支
- **feature/***: 功能分支，从 develop 拉取，完成后合并回 develop

### 2. 工作流程
```bash
# 1. 从develop拉取新功能分支
git checkout develop
git pull
git checkout -b feature/xxx

# 2. 在子模块中同步创建相同分支
cd frontend
git checkout develop
git pull
git checkout -b feature/xxx

# 3. 开发完成后的合并流程
# 先合并前端子模块
cd frontend
git checkout develop
git merge feature/xxx

# 再合并主仓库
cd ..
git checkout develop
git merge feature/xxx
```

### 3. 分支管理原则
- 所有新功能开发都从 develop 分支拉取
- 功能开发完成后合并回 develop 分支
- 定期从 develop 分支合并到 main 分支进行发布

### 4. 子模块同步原则
- 主仓库和子模块保持相同的分支结构
- 分支操作时同步处理主仓库和子模块
- 合并时先处理子模块，再处理主仓库

## 二、提交信息规范

### 1. 提交信息格式
```
<类型>(<范围>): <描述>

[可选的正文]

[可选的脚注]
```

### 2. 提交类型
- **feat**: 新功能
- **fix**: 修复缺陷
- **docs**: 文档更新
- **style**: 代码格式调整
- **refactor**: 代码重构
- **perf**: 性能优化
- **test**: 测试相关
- **chore**: 构建/工具链/辅助工具的变动

### 3. 范围说明
- **core**: 核心功能
- **ui**: 界面相关
- **api**: API相关
- **auth**: 认证相关
- **data**: 数据相关
- **deps**: 依赖相关

## 三、版本号规范

### 1. 版本号格式
采用语义化版本号（Semantic Versioning）：`主版本号.次版本号.修订号`
- 例如：1.2.3

### 2. 版本号递增规则
- **主版本号**：当进行不兼容的 API 修改时
- **次版本号**：当添加功能时（向下兼容）
- **修订号**：当进行向下兼容的缺陷修复时

## 四、代码评审规范

### 1. 评审重点
- 代码质量和规范性
- 功能完整性
- 测试覆盖
- 性能影响
- 安全隐患

### 2. 评审流程
1. 提交合并请求
2. 指定评审人
3. 评审人反馈
4. 修改完善
5. 评审通过
6. 合并代码

## 五、发布流程

### 1. 发布步骤
1. develop 分支功能开发完成并测试通过
2. 将 develop 分支合并到 main 分支
3. 在 main 分支打版本标签
4. 部署到生产环境

### 2. 版本标签管理
- 标签命名：v版本号
- 例如：v1.2.3
- 包含版本描述信息
- 为每个正式发布版本打标签

## 六、紧急修复流程

### 1. 修复步骤
1. 从 develop 分支创建紧急修复分支
2. 在修复分支进行修复
3. 测试验证
4. 合并回 develop 分支
5. 必要时合并到 main 分支并发布新版本

### 2. 注意事项
- 确保修复的完整性
- 同步处理主仓库和子模块
- 及时更新文档和版本号