# 任务创建流程设计文档

## 1. 设计理念

基于情感驱动的任务管理系统，通过识别用户的不同驱动力来提供个性化的任务创建体验。

### 1.1 核心理念
- 从用户的真实情感需求出发
- 提供差异化的任务创建流程
- 智能化辅助但保持用户控制

### 1.2 驱动力类型

1. 压力驱动型
   - 特点：有很多事要处理，需要理清头绪
   - 场景：任务堆积，压力大
   - 需求：梳理和减压

2. 目标驱动型
   - 特点：有明确目标要实现
   - 场景：重要项目或个人目标
   - 需求：规划和追踪

3. 习惯记录型
   - 特点：日常任务记录
   - 场景：例行事务管理
   - 需求：快速记录和管理

## 2. 交互流程

### 2.1 入口对话
```
助手: "让我们开始创建任务。首先，是什么促使你现在要记录这个任务？"

[提供三种驱动力选项]
- 压力驱动：感觉压力有点大
- 目标驱动：我有重要目标
- 习惯记录：日常任务记录
```

### 2.2 差异化流程

#### 压力驱动流程
1. 快速倾倒（Brain Dump）
2. 压力源分类
3. 任务提炼
4. 时间规划

#### 目标驱动流程
1. SMART目标描述
2. 里程碑规划
3. 行动步骤
4. 资源评估

#### 习惯记录流程
1. 快速录入
2. 批量创建
3. 模板应用

## 3. LLM 智能增强

### 3.1 处理内容
- 任务分析和分类
- 优先级识别
- 时间建议
- 执行建议
- 相关任务关联

### 3.2 智能建议展示
```
[任务分析结果]
- 优先级
- 分类
- 预计时间
- 建议标签

[任务拆解建议]
- 具体步骤
- 执行顺序

[时间安排建议]
- 建议执行时间
- 缓冲时间
```

## 4. 用户确认机制

### 4.1 确认选项
1. 完全采纳
   - 直接创建任务
   - 应用所有建议

2. 编辑后采纳
   - 修改建议内容
   - 确认后创建

3. 重新规划
   - 返回处理阶段
   - 重新生成建议

4. 仅保存基本信息
   - 忽略所有建议
   - 只保存用户输入

### 4.2 编辑功能
- 支持直接编辑建议内容
- 每项建议独立编辑
- 保留原始建议参考
- 实时预览修改效果

## 5. 界面设计

### 5.1 对话式界面
- 保持简洁清晰
- 渐进式信息展示
- 自然的对话流程
- 视觉反馈明确

### 5.2 卡片式布局
- 信息分类清晰
- 操作便捷直观
- 支持拖拽调整
- 状态显示明确

## 6. 后续优化方向

### 6.1 功能优化
- 模板系统完善
- 智能建议优化
- 用户习惯学习
- 协作功能集成

### 6.2 体验优化
- 性能优化
- 响应速度提升
- 动画效果优化
- 移动端适配

## 7. 注意事项

### 7.1 用户体验
- 保持操作简单直观
- 避免过度智能化
- 确保用户控制权
- 提供充分反馈

### 7.2 系统性能
- 控制LLM响应时间
- 优化数据处理
- 确保界面流畅
- 处理异常情况 

## 8. 技术实现步骤

### 8.1 第一阶段：基础框架搭建

#### 8.1.1 数据模型扩展
```typescript
interface Task {
  // 现有字段...
  drivingForce: 'pressure' | 'goal' | 'routine'; // 驱动力类型
  brainDump?: string;        // 压力驱动时的思维导出
  smartGoal?: {             // 目标驱动时的 SMART 目标
    specific: string;
    measurable: string;
    achievable: string;
    relevant: string;
    timeBound: string;
  };
  milestones?: Milestone[]; // 目标驱动时的里程碑
  template?: string;        // 习惯记录时的模板引用
}
```

#### 8.1.2 UI 组件开发
- 改造 `ChatTaskCreator` 组件，支持三种驱动力模式
- 实现驱动力选择的卡片界面
- 开发各个驱动力对应的输入组件
- 实现确认机制的界面组件

### 8.2 第二阶段：驱动力模式实现

#### 8.2.1 压力驱动模式
```typescript
// 组件结构
- BrainDumpInput    // 思维导出输入
- PressureCategory  // 压力源分类
- TaskExtractor     // 任务提炼器
- TimeAllocator     // 时间分配器
```

#### 8.2.2 目标驱动模式
```typescript
// 组件结构
- SmartGoalForm     // SMART目标表单
- MilestonePlanner  // 里程碑规划器
- ActionStepBuilder // 行动步骤构建器
- ResourceAnalyzer  // 资源评估工具
```

#### 8.2.3 习惯记录模式
```typescript
// 组件结构
- QuickEntryForm    // 快速录入表单
- BatchCreator      // 批量创建工具
- TemplateSelector  // 模板选择器
```

### 8.3 第三阶段：LLM 集成

#### 8.3.1 API 设计
```typescript
interface LLMService {
  // 任务分析
  analyzeTask(input: string): Promise<TaskAnalysis>;
  // 建议生成
  generateSuggestions(task: Task): Promise<TaskSuggestions>;
  // 时间规划
  planSchedule(task: Task): Promise<SchedulePlan>;
}
```

#### 8.3.2 处理器开发
- 实现任务分析算法
- 开发建议生成逻辑
- 创建时间规划引擎
- 实现相关任务关联

### 8.4 第四阶段：确认机制实现

#### 8.4.1 状态管理
```typescript
interface TaskCreationState {
  currentStep: string;
  drivingForce: string;
  userInput: any;
  llmSuggestions: any;
  editedSuggestions: any;
}
```

#### 8.4.2 操作处理
- 完全采纳逻辑
- 编辑后采纳流程
- 重新规划处理
- 基本信息保存

### 8.5 第五阶段：优化和集成

#### 8.5.1 性能优化
- LLM 响应缓存
- 界面渲染优化
- 数据处理优化

#### 8.5.2 用户体验提升
- 添加动画效果
- 优化交互流程
- 完善错误处理

#### 8.5.3 测试和调优
- 单元测试
- 集成测试
- 性能测试
- 用户体验测试

### 8.6 开发优先级

#### 8.6.1 MVP阶段（必须实现）
- 基础框架搭建
- 三种驱动力的基本流程
- 简单的 LLM 集成
- 基础确认机制

#### 8.6.2 增强阶段
- 完整的 LLM 功能
- 高级编辑功能
- 模板系统
- 批量处理

#### 8.6.3 优化阶段
- 性能优化
- 用户体验提升
- 移动端适配
- 协作功能